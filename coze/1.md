# Coze Shopify è®¢å•æŸ¥è¯¢æ’ä»¶é…ç½®æŒ‡å—

## ä¸€ã€API æ¸…å•

å…± **6 ä¸ª API**ï¼Œå…¶ä¸­ **4 ä¸ªå¸¸ç”¨**ï¼š

| API | åŠŸèƒ½ | è¾“å…¥å‚æ•° | ä½¿ç”¨åœºæ™¯ |
|-----|------|---------|---------|
| `searchOrderByNumber` | æŒ‰è®¢å•å·æœç´¢è®¢å• | `q`: è®¢å•å· | â­ å¸¸ç”¨ - ç”¨æˆ·æä¾›è®¢å•å·æ—¶ |
| `getOrdersByEmail` | æŒ‰é‚®ç®±æŸ¥è¯¢è®¢å•åˆ—è¡¨ | `email`: é‚®ç®± | â­ å¸¸ç”¨ - ç”¨æˆ·æä¾›é‚®ç®±æ—¶ |
| `getOrderTracking` | è·å–ç‰©æµè¿½è¸ªä¿¡æ¯ | `order_id`: Shopifyå†…éƒ¨ID | â­ å¸¸ç”¨ - æŸ¥è¯¢ç‰©æµçŠ¶æ€ |
| `getOrderDetail` | è·å–è®¢å•è¯¦æƒ… | `order_id`: Shopifyå†…éƒ¨ID | å¤‡ç”¨ - å·²æœ‰order_idæ—¶ |
| `getOrderCount` | è®¢å•æ•°é‡ç»Ÿè®¡ | `status`: çŠ¶æ€ç­›é€‰ | ç»Ÿè®¡ç”¨ |
| `healthCheck` | å¥åº·æ£€æŸ¥ | æ—  | æµ‹è¯•APIè¿æ¥ |

---

## äºŒã€æ„å›¾åˆ†ç±»ï¼ˆ5ä¸ªï¼‰

| æ„å›¾ | è§¦å‘æ¡ä»¶ | è°ƒç”¨API | è¯´æ˜ |
|------|---------|---------|------|
| **order_query** | ç”¨æˆ·æä¾›äº†è®¢å•å· | searchOrderByNumber â†’ getOrderTracking | æŸ¥è®¢å•è¯¦æƒ…+ç‰©æµ |
| **order_list** | ç”¨æˆ·æä¾›äº†é‚®ç®±ï¼Œæ²¡æœ‰è®¢å•å· | getOrdersByEmail | æŸ¥è¯¥å®¢æˆ·çš„è®¢å•åˆ—è¡¨ |
| **order_guide** | æƒ³æŸ¥è®¢å•ä½†æ²¡æœ‰æä¾›è®¢å•å·å’Œé‚®ç®± | æ—  | å¼•å¯¼ç”¨æˆ·æä¾›ä¿¡æ¯ |
| **product_consult** | å’¨è¯¢Fiidoäº§å“ç›¸å…³é—®é¢˜ | çŸ¥è¯†åº“æ£€ç´¢ | äº§å“å’¨è¯¢ |
| **general_chat** | é—²èŠã€é—®å€™ã€æ— å…³é—®é¢˜ | æ—  | é€šç”¨å›å¤ |

---

## ä¸‰ã€Coze å·¥ä½œæµèŠ‚ç‚¹é…ç½®

### æ•´ä½“æµç¨‹å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    å¼€å§‹     â”‚
                    â”‚  (ç”¨æˆ·è¾“å…¥)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ èŠ‚ç‚¹1: æ„å›¾è¯†åˆ« â”‚
                    â”‚   (LLMèŠ‚ç‚¹)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ èŠ‚ç‚¹2: JSONè§£æ â”‚
                    â”‚ (Deserialization) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ èŠ‚ç‚¹3: é€‰æ‹©å™¨  â”‚
                    â”‚  (åˆ†æ”¯èŠ‚ç‚¹)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“      â†“      â†“         â†“          â†“
   order_   order_  order_   product_   general_
   query    list    guide    consult    chat
        â†“      â†“      â†“         â†“          â†“
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”  â”‚      â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”     â”‚
   â”‚è®¢å•æŸ¥è¯¢ â”‚  â”‚      â”‚    â”‚çŸ¥è¯†åº“æ£€ç´¢â”‚     â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚      â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â”‚
        â†“      â†“      â†“         â†“          â†“
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”  â”‚      â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”     â”‚
   â”‚ç‰©æµæŸ¥è¯¢ â”‚  â”‚      â”‚    â”‚æ™ºèƒ½å›å¤  â”‚     â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚      â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â”‚
        â†“      â†“      â†“         â†“          â†“
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
   â”‚              æ ¼å¼åŒ–å›å¤ (LLM)                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç»“æŸ   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### èŠ‚ç‚¹1: æ„å›¾è¯†åˆ«ï¼ˆLLMèŠ‚ç‚¹ï¼‰

**èŠ‚ç‚¹åç§°**: `æ„å›¾è¯†åˆ«`

**Prompt**: å‚è€ƒ `prompts/æ„å›¾è¯†åˆ«.md`

**è¾“å‡ºæ ¼å¼ï¼ˆJSONï¼‰**:
```json
{
  "intent": "order_query|order_list|order_guide|product_consult|general_chat",
  "sub_intent": "product_info|product_compare|product_price|product_purchase|product_aftermarket|product_usage|null",
  "order_number": "æå–çš„è®¢å•å·æˆ–null",
  "email": "æå–çš„é‚®ç®±æˆ–null",
  "confidence": 0.95,
  "reason": "åˆ¤æ–­ç†ç”±"
}
```

**è¾“å‡ºå˜é‡**: `intent_output`

---

### èŠ‚ç‚¹2: JSON Deserialization

**èŠ‚ç‚¹åç§°**: `JSONè§£æ`

**è¾“å…¥**: `{{intent_output}}`

**è¾“å‡ºå˜é‡**: `parsed`

**è¾“å‡ºå­—æ®µ**:
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `intent` | String | æ„å›¾ç±»å‹ |
| `sub_intent` | String | å­æ„å›¾ï¼ˆäº§å“å’¨è¯¢ç”¨ï¼‰ |
| `order_number` | String | è®¢å•å· |
| `email` | String | é‚®ç®± |
| `confidence` | Number | ç½®ä¿¡åº¦ |
| `reason` | String | åˆ¤æ–­ç†ç”± |

---

### èŠ‚ç‚¹3: é€‰æ‹©å™¨ï¼ˆåˆ†æ”¯èŠ‚ç‚¹ï¼‰

**åˆ†æ”¯æ¡ä»¶**:

| åˆ†æ”¯ | æ¡ä»¶ | èµ°å‘ |
|------|------|------|
| åˆ†æ”¯1 | `{{parsed.intent}} == "order_query"` | â†’ è®¢å•æŸ¥è¯¢èŠ‚ç‚¹ |
| åˆ†æ”¯2 | `{{parsed.intent}} == "order_list"` | â†’ é‚®ç®±æŸ¥è¯¢èŠ‚ç‚¹ |
| åˆ†æ”¯3 | `{{parsed.intent}} == "order_guide"` | â†’ å¼•å¯¼å›å¤èŠ‚ç‚¹ |
| åˆ†æ”¯4 | `{{parsed.intent}} == "product_consult"` | â†’ äº§å“å’¨è¯¢èŠ‚ç‚¹ |
| é»˜è®¤ | å…¶ä»–æƒ…å†µ | â†’ é€šç”¨å›å¤èŠ‚ç‚¹ |

---

### åˆ†æ”¯1: order_queryï¼ˆè®¢å•æŸ¥è¯¢æµç¨‹ï¼‰

#### èŠ‚ç‚¹4A: è®¢å•æŸ¥è¯¢ï¼ˆæ’ä»¶èŠ‚ç‚¹ï¼‰

**èŠ‚ç‚¹åç§°**: `è®¢å•æŸ¥è¯¢`

**è°ƒç”¨å·¥å…·**: `searchOrderByNumber`

**è¾“å…¥å‚æ•°**:
```
q: {{parsed.order_number}}
```

**è¾“å‡ºå˜é‡**: `order_result`

#### èŠ‚ç‚¹4B: ç‰©æµæŸ¥è¯¢ï¼ˆæ’ä»¶èŠ‚ç‚¹ï¼‰

**èŠ‚ç‚¹åç§°**: `ç‰©æµæŸ¥è¯¢`

**è°ƒç”¨å·¥å…·**: `getOrderTracking`

**è¾“å…¥å‚æ•°**:
```
order_id: {{order_result.data.order.order_id}}
```

**è¾“å‡ºå˜é‡**: `tracking_result`

#### èŠ‚ç‚¹4C: è®¢å•å›å¤ï¼ˆLLMèŠ‚ç‚¹ï¼‰

**Prompt**:
```
æ ¹æ®è®¢å•å’Œç‰©æµæ•°æ®ï¼Œç”¨è‹±æ–‡ç”Ÿæˆå‹å¥½çš„å®¢æœå›å¤ã€‚

## è®¢å•æ•°æ®
{{order_result}}

## ç‰©æµæ•°æ®
{{tracking_result}}

## å›å¤è¦æ±‚
1. ä½¿ç”¨å‹å¥½ä¸“ä¸šçš„è‹±æ–‡å£å»
2. çªå‡ºè®¢å•çŠ¶æ€å’Œç‰©æµä¿¡æ¯
3. å¦‚æœæœ‰è¿å•å·ï¼Œæä¾›ç»™ç”¨æˆ·
4. å¦‚æœæœªå‘è´§ï¼Œå‘ŠçŸ¥ä¼šå°½å¿«å®‰æ’

## å›å¤æ¨¡æ¿
Hi! Here's the information for your order {{order_number}}:

ğŸ“¦ Order Status: {{fulfillment_status}}
ğŸ’° Total: {{total_price}} {{currency}}
ğŸ“… Order Date: {{created_at}}

ğŸšš Shipping Status: {{shipping_status}}
Carrier: {{tracking_company}}
Tracking Number: {{tracking_number}}

If you have any other questions, feel free to ask!
```

---

### åˆ†æ”¯2: order_listï¼ˆé‚®ç®±æŸ¥è¯¢æµç¨‹ï¼‰

#### èŠ‚ç‚¹5A: é‚®ç®±æŸ¥è¯¢ï¼ˆæ’ä»¶èŠ‚ç‚¹ï¼‰

**èŠ‚ç‚¹åç§°**: `é‚®ç®±æŸ¥è¯¢`

**è°ƒç”¨å·¥å…·**: `getOrdersByEmail`

**è¾“å…¥å‚æ•°**:
```
email: {{parsed.email}}
limit: 5
```

**è¾“å‡ºå˜é‡**: `order_list_result`

#### èŠ‚ç‚¹5B: è®¢å•åˆ—è¡¨å›å¤ï¼ˆLLMèŠ‚ç‚¹ï¼‰

**Prompt**:
```
æ ¹æ®è®¢å•åˆ—è¡¨æ•°æ®ï¼Œç”¨è‹±æ–‡ç”Ÿæˆå‹å¥½çš„å®¢æœå›å¤ã€‚

## è®¢å•åˆ—è¡¨æ•°æ®
{{order_list_result}}

## å›å¤è¦æ±‚
1. åˆ—å‡ºæ‰€æœ‰è®¢å•çš„åŸºæœ¬ä¿¡æ¯
2. çªå‡ºè®¢å•å·ã€é‡‘é¢ã€çŠ¶æ€
3. è¯¢é—®ç”¨æˆ·éœ€è¦æŸ¥è¯¢å“ªä¸ªè®¢å•çš„è¯¦æƒ…

## å›å¤æ¨¡æ¿
Hi! Here are the orders associated with your email:

ğŸ“¦ Order {{order_number}}
   Amount: {{total_price}} {{currency}}
   Status: {{fulfillment_status}}
   Date: {{created_at}}

Which order would you like to know more about?
```

---

### åˆ†æ”¯3: order_guideï¼ˆå¼•å¯¼å›å¤ï¼‰

**èŠ‚ç‚¹åç§°**: `å¼•å¯¼å›å¤`

**ç±»å‹**: æ–‡æœ¬è¾“å‡º æˆ– LLMèŠ‚ç‚¹

**è¾“å‡ºå†…å®¹**:
```
Hi! I can help you check your order status.

Please provide one of the following:
1. ğŸ“ Order number (e.g., UK22080)
2. ğŸ“§ Email address used for the order

With this information, I can look up your order and shipping details!
```

---

### åˆ†æ”¯4: product_consultï¼ˆäº§å“å’¨è¯¢æµç¨‹ï¼‰

#### èŠ‚ç‚¹6A: çŸ¥è¯†åº“æ£€ç´¢ï¼ˆKnowledgeèŠ‚ç‚¹ï¼‰

**çŸ¥è¯†åº“**: Fiido äº§å“çŸ¥è¯†åº“

#### èŠ‚ç‚¹6B: æ™ºèƒ½å›å¤ï¼ˆLLMèŠ‚ç‚¹ï¼‰

**Prompt**: å‚è€ƒ `prompts/1.md` ä¸­çš„å®Œæ•´è§’è‰²è®¾å®š

---

### åˆ†æ”¯5: general_chatï¼ˆé€šç”¨å›å¤ï¼‰

**èŠ‚ç‚¹åç§°**: `é€šç”¨å›å¤`

**Prompt**:
```
ä½ æ˜¯ Fiido æ™ºèƒ½å®¢æœã€‚ç”¨æˆ·è¿›è¡Œäº†é—²èŠæˆ–é—®å€™ã€‚

ç”¨å‹å¥½çš„æ–¹å¼å›åº”ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·å’¨è¯¢äº§å“æˆ–è®¢å•é—®é¢˜ã€‚

ç”¨æˆ·è¾“å…¥: {{user_input}}
```

---

## å››ã€æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•1: è®¢å•å·æŸ¥è¯¢
```
ç”¨æˆ·: å¸®æˆ‘æŸ¥ä¸€ä¸‹è®¢å•UK22080
é¢„æœŸæ„å›¾: order_query
é¢„æœŸæµç¨‹: searchOrderByNumber â†’ getOrderTracking â†’ è¿”å›è®¢å•è¯¦æƒ…å’Œç‰©æµä¿¡æ¯
```

### æµ‹è¯•2: é‚®ç®±æŸ¥è¯¢
```
ç”¨æˆ·: æˆ‘çš„é‚®ç®±æ˜¯ danielharris343@gmail.comï¼ŒæŸ¥ä¸€ä¸‹æˆ‘çš„è®¢å•
é¢„æœŸæ„å›¾: order_list
é¢„æœŸæµç¨‹: getOrdersByEmail â†’ è¿”å›è®¢å•åˆ—è¡¨
```

### æµ‹è¯•3: æ— ä¿¡æ¯æŸ¥è¯¢
```
ç”¨æˆ·: æˆ‘æƒ³æŸ¥è®¢å•
é¢„æœŸæ„å›¾: order_guide
é¢„æœŸæµç¨‹: è¿”å›å¼•å¯¼ä¿¡æ¯ï¼Œè¯·ç”¨æˆ·æä¾›è®¢å•å·æˆ–é‚®ç®±
```

### æµ‹è¯•4: ç‰©æµæŸ¥è¯¢
```
ç”¨æˆ·: UK22080çš„ç‰©æµåˆ°å“ªäº†
é¢„æœŸæ„å›¾: order_query
é¢„æœŸæµç¨‹: searchOrderByNumber â†’ getOrderTracking â†’ è¿”å›ç‰©æµè¯¦æƒ…
```

### æµ‹è¯•5: äº§å“å’¨è¯¢
```
ç”¨æˆ·: C11 Pro ç»­èˆªå¤šå°‘å…¬é‡Œ
é¢„æœŸæ„å›¾: product_consult
é¢„æœŸæµç¨‹: çŸ¥è¯†åº“æ£€ç´¢ â†’ æ™ºèƒ½å›å¤
```

### æµ‹è¯•6: é—²èŠ
```
ç”¨æˆ·: ä½ å¥½
é¢„æœŸæ„å›¾: general_chat
é¢„æœŸæµç¨‹: é€šç”¨å›å¤
```

---

## äº”ã€æ³¨æ„äº‹é¡¹

1. **order_id vs order_number**
   - `order_number`: ç”¨æˆ·çœ‹åˆ°çš„è®¢å•å·ï¼ˆå¦‚ UK22080ï¼‰
   - `order_id`: Shopifyå†…éƒ¨IDï¼ˆå¦‚ 6615015620909ï¼‰
   - ç‰©æµæŸ¥è¯¢éœ€è¦ `order_id`ï¼Œæ‰€ä»¥å¿…é¡»å…ˆé€šè¿‡è®¢å•å·æœç´¢è·å–

2. **API è°ƒç”¨é“¾è·¯**
   - è®¢å•æŸ¥è¯¢: `searchOrderByNumber` â†’ `getOrderTracking`
   - é‚®ç®±æŸ¥è¯¢: `getOrdersByEmail`ï¼ˆç›´æ¥è¿”å›åˆ—è¡¨ï¼‰

3. **é”™è¯¯å¤„ç†**
   - è®¢å•ä¸å­˜åœ¨: APIè¿”å›404ï¼Œæç¤ºç”¨æˆ·æ£€æŸ¥è®¢å•å·
   - é‚®ç®±æ— è®¢å•: APIè¿”å›ç©ºåˆ—è¡¨ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤é‚®ç®±

4. **JSONè§£æèŠ‚ç‚¹**
   - å¿…é¡»æ”¾åœ¨æ„å›¾è¯†åˆ«LLMä¹‹åã€é€‰æ‹©å™¨ä¹‹å‰
   - ç”¨äºå°†LLMè¾“å‡ºçš„JSONå­—ç¬¦ä¸²è§£æä¸ºç»“æ„åŒ–å¯¹è±¡
   - è§£æåçš„å­—æ®µå¯åœ¨åç»­èŠ‚ç‚¹ä¸­ç›´æ¥å¼•ç”¨

5. **è¯­è¨€é€‚é…**
   - Fiido UK é¢å‘è‹±å›½å¸‚åœºï¼Œå›å¤é»˜è®¤ä½¿ç”¨è‹±æ–‡
   - å¯æ ¹æ®ç”¨æˆ·è¾“å…¥è¯­è¨€è‡ªåŠ¨åˆ‡æ¢

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æ›´æ–°æ—¶é—´**: 2025-12-10
