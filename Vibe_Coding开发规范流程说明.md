# Vibe Coding 开发规范流程说明

> 基于 Nicolas Zullo 的 "Ultimate Guide to Vibe Coding V1.2" 整理
> 原文链接: https://github.com/EnzeD/vibe-coding
> 整理日期: 2025-12-16

---

## 📖 核心理念

> **"规划就是一切。不要让 AI 自主规划，否则你的代码库会变成一团乱麻。"**

Vibe Coding 是一套使用 AI 工具进行快速开发的结构化方法论，核心思想是：

1. **文档驱动开发** - 先写文档，再写代码
2. **小步快跑** - 每步只做一件小事，立即测试验证
3. **上下文管理** - 通过 Memory Bank 保持 AI 上下文一致性
4. **频繁提交** - 每步完成后立即 Git 提交，便于回滚

---

## 🗂️ 第一阶段：项目初始化

### 1.1 创建 Memory Bank 文件夹

**操作步骤：**

```bash
# 在项目根目录创建 memory-bank 文件夹
mkdir -p memory-bank
```

**需要创建的文件清单：**


| 文件名                   | 用途         | 初始状态 |
| ------------------------ | ------------ | -------- |
| `prd.md`                 | 产品需求文档 | 需生成   |
| `tech-stack.md`          | 技术栈说明   | 需生成   |
| `implementation-plan.md` | 分步实现计划 | 需生成   |
| `progress.md`            | 进度追踪     | 空文件   |
| `architecture.md`        | 架构说明     | 空文件   |

---

### 1.2 生成产品需求文档 (PRD)

**文件名：** `memory-bank/prd.md`

**生成提示词：**

```
我要开发一个 [产品/功能描述]。

请帮我生成一个简洁的产品需求文档 (PRD)，包含以下部分：

1. 产品概述
   - 产品名称
   - 目标用户
   - 核心价值

2. 功能列表
   - 核心功能（必须实现）
   - 扩展功能（后续迭代）

3. 用户故事
   - 列出 3-5 个主要用户场景

4. 成功标准
   - 如何判断功能开发成功

要求：
- 保持简洁，不要过度设计
- 使用 Markdown 格式
- 先聚焦核心功能，细节后续迭代
```

**示例输出：**

```markdown
# 客户满意度评分系统 PRD

## 1. 产品概述

### 产品名称
客户满意度评分系统

### 目标用户
- 完成客服对话的终端用户
- 需要查看满意度数据的管理员

### 核心价值
收集用户对客服服务的反馈，帮助改进服务质量

## 2. 功能列表

### 核心功能（P0）
- [ ] 对话结束后展示评分弹窗
- [ ] 用户可选择 1-5 星评分
- [ ] 用户可填写可选评价文字
- [ ] 后台可查看评分统计

### 扩展功能（P1）
- [ ] 评分趋势图表
- [ ] 按坐席筛选评分
- [ ] 差评自动预警

## 3. 用户故事

1. 作为用户，我希望在对话结束后能快速评价服务质量
2. 作为管理员，我希望能看到整体满意度统计
3. 作为坐席，我希望能看到自己的服务评分

## 4. 成功标准

- 评分提交成功率 > 95%
- 评分弹窗加载时间 < 500ms
- 用户评分参与率 > 30%
```

---

### 1.3 生成技术栈文档

**文件名：** `memory-bank/tech-stack.md`

**生成提示词：**

```
我正在开发 [产品描述]，请为我推荐最合适的技术栈。

当前项目已有技术栈：
- 后端: [Python/FastAPI/其他]
- 前端: [Vue/React/其他]
- 数据库: [Redis/MySQL/其他]

请基于现有技术栈，为新功能推荐：
1. 最简单但最健壮的实现方案
2. 需要的新依赖（如果有）
3. 数据存储方案
4. API 设计建议

要求：
- 优先复用现有技术栈
- 避免引入不必要的新依赖
- 保持方案简单
```

**示例输出：**

```markdown
# 客户满意度评分系统 - 技术栈

## 复用现有技术栈

| 层级 | 技术 | 说明 |
|------|------|------|
| 后端 | FastAPI | 已有，直接复用 |
| 前端 | Vue 3 + TypeScript | 已有，直接复用 |
| 数据存储 | Redis | 已有，扩展数据结构 |

## 新增依赖

无需新增依赖

## 数据存储方案

```python
# Redis 数据结构
satisfaction:{session_id} = {
    "rating": 5,
    "comment": "服务很好",
    "created_at": "2025-12-16T10:00:00Z"
}

# 统计数据
satisfaction:stats:daily:{date} = {
    "total": 100,
    "avg_rating": 4.5,
    "ratings": {"1": 5, "2": 10, "3": 15, "4": 30, "5": 40}
}
```

## API 设计


| 方法 | 路径                    | 说明     |
| ---- | ----------------------- | -------- |
| POST | /api/satisfaction/rate  | 提交评分 |
| GET  | /api/satisfaction/stats | 获取统计 |

```

---

### 1.4 生成实现计划

**文件名：** `memory-bank/implementation-plan.md`

**生成提示词：**

```

请根据以下文档生成详细的实现计划：

【PRD 文档】
[粘贴 prd.md 内容]

【技术栈文档】
[粘贴 tech-stack.md 内容]

请生成 implementation-plan.md，要求：

1. 每个步骤要小且具体（单个 API 或单个组件）
2. 每个步骤必须包含验证测试
3. 只写指令，不写具体代码
4. 先实现核心功能，扩展功能放后面
5. 步骤之间有明确的依赖关系

格式要求：

## Step N: 步骤标题

- 任务描述（做什么）
- 涉及文件（改哪里）
- 测试方法（如何验证）
- 预期结果（通过标准）

```

**示例输出：**

```markdown
# 客户满意度评分系统 - 实现计划

> 预计步骤数: 6
> 核心功能步骤: Step 1-4
> 扩展功能步骤: Step 5-6

---

## Step 1: 创建评分提交 API

**任务描述：**
创建 POST /api/satisfaction/rate 端点，接收用户评分

**涉及文件：**
- `backend.py` 或 `src/satisfaction.py`（新建）

**接口规格：**
```json
// 请求
POST /api/satisfaction/rate
{
    "session_id": "user_xxx",
    "rating": 5,
    "comment": "服务很好"  // 可选
}

// 响应
{
    "success": true,
    "message": "评分已提交"
}
```

**测试方法：**

```bash
curl -X POST http://localhost:8000/api/satisfaction/rate \
  -H "Content-Type: application/json" \
  -d '{"session_id": "test_001", "rating": 5, "comment": "很满意"}'
```

**预期结果：**

- 返回状态码 200
- 返回 `{"success": true}`
- Redis 中已存储数据

---

## Step 2: 创建评分统计 API

**任务描述：**
创建 GET /api/satisfaction/stats 端点，返回评分统计

**涉及文件：**

- `backend.py` 或 `src/satisfaction.py`

**接口规格：**

```json
// 响应
{
    "total_count": 100,
    "average_rating": 4.5,
    "rating_distribution": {
        "1": 5,
        "2": 10,
        "3": 15,
        "4": 30,
        "5": 40
    }
}
```

**测试方法：**

```bash
curl http://localhost:8000/api/satisfaction/stats
```

**预期结果：**

- 返回状态码 200
- 返回正确的统计数据结构

---

## Step 3: 前端评分组件

**任务描述：**
创建 5 星评分组件，支持点击选择和可选评论

**涉及文件：**

- `frontend/src/components/SatisfactionRating.vue`（新建）

**组件功能：**

- 显示 5 个可点击的星星
- 点击星星选择评分
- 可选的评论输入框
- 提交按钮

**测试方法：**

1. 启动前端 `npm run dev`
2. 在页面中引入组件
3. 点击星星验证选中效果
4. 提交验证 API 调用

**预期结果：**

- 星星可点击且有视觉反馈
- 提交后调用 API 成功

---

## Step 4: 集成评分弹窗

**任务描述：**
在对话结束时自动弹出评分组件

**涉及文件：**

- `frontend/src/views/Chat.vue` 或相关聊天组件

**触发条件：**

- 用户点击"结束对话"按钮
- 或收到会话结束事件

**测试方法：**

1. 进行一次完整对话
2. 点击结束对话
3. 验证评分弹窗出现

**预期结果：**

- 对话结束后弹窗出现
- 评分提交后弹窗关闭

---

## Step 5: 坐席工作台统计展示（扩展）

**任务描述：**
在坐席工作台展示满意度统计数据

**涉及文件：**

- `agent-workbench/src/views/Dashboard.vue` 或新建统计页面

**测试方法：**

1. 登录坐席工作台
2. 查看统计页面
3. 验证数据正确显示

**预期结果：**

- 显示总评分数、平均分
- 显示评分分布图表

---

## Step 6: 添加测试到回归测试（收尾）

**任务描述：**
将满意度功能测试集成到回归测试脚本

**涉及文件：**

- `tests/test_satisfaction.sh`（新建）
- `tests/regression_test.sh`（追加）

**测试方法：**

```bash
./tests/regression_test.sh
```

**预期结果：**

- 所有测试通过
- 包含满意度功能测试

```

---

### 1.5 创建空白追踪文件

**创建 progress.md：**

```bash
touch memory-bank/progress.md
```

初始内容：

```markdown
# 开发进度追踪

> 功能: [功能名称]
> 开始日期: YYYY-MM-DD
> 当前步骤: Step 1

---

## 完成记录

（每完成一步在此记录）
```

**创建 architecture.md：**

```bash
touch memory-bank/architecture.md
```

初始内容：

```markdown
# 架构说明

> 功能: [功能名称]
> 最后更新: YYYY-MM-DD

---

## 文件结构

（每新增文件在此说明用途）

## 数据流

（说明数据如何流转）

## 关键设计决策

（记录重要的设计选择及原因）
```

---

## 🔄 第二阶段：开发工作流

### 2.1 开始前：确认计划清晰

**工作流：** 在开始编码前，先让 AI 确认理解了实现计划

**提示词：**

```
请阅读 memory-bank/ 中的所有文档：
- prd.md
- tech-stack.md
- implementation-plan.md
- progress.md
- architecture.md

implementation-plan.md 清晰吗？
你有什么问题可以让它 100% 清晰？
```

**预期结果：**

- AI 会问 5-10 个澄清问题
- 回答问题后，让 AI 更新 implementation-plan.md

**后续提示词：**

```
根据我的回答，请更新 implementation-plan.md，使其更加清晰和完整。
```

---

### 2.2 执行单个步骤

**工作流：** 每次只执行一个步骤，测试通过后再继续

**标准提示词模板：**

```
请阅读 memory-bank/ 中的所有文档，
查看 progress.md 了解之前完成的工作，
现在执行实现计划的 Step [N]。

要求：
1. 我会运行测试，测试通过前不要开始下一步
2. 只做这一步要求的内容，不要超前
3. 如果有疑问，先问我

开始吧。
```

**示例（执行 Step 1）：**

```
请阅读 memory-bank/ 中的所有文档，
查看 progress.md 了解之前完成的工作，
现在执行实现计划的 Step 1: 创建评分提交 API。

要求：
1. 我会运行测试，测试通过前不要开始 Step 2
2. 只做 Step 1 要求的内容
3. 完成后告诉我如何测试

开始吧。
```

---

### 2.3 测试验证

**工作流：** 按照 implementation-plan.md 中的测试方法验证

**测试通过后的提示词：**

```
测试通过。请执行以下操作：

1. 更新 memory-bank/progress.md，记录 Step [N] 完成内容
2. 更新 memory-bank/architecture.md，说明新增/修改的文件用途
3. 告诉我可以继续 Step [N+1] 了
```

**测试失败后的提示词：**

```
测试失败，错误信息如下：

[粘贴错误信息]

请分析原因并修复，不要继续下一步。
```

---

### 2.4 Git 提交

**工作流：** 每个步骤完成后立即提交

**操作步骤：**

```bash
# 1. 查看改动
git status
git diff

# 2. 添加文件
git add .

# 3. 提交（包含步骤信息）
git commit -m "feat: Step N - 步骤描述 vX.X.X"

# 4. 打标签
git tag vX.X.X

# 5. 推送（可选，等功能完成后统一推送）
git push origin main --tags
```

**示例：**

```bash
git add .
git commit -m "feat: Step 1 - 创建评分提交API v5.4.1"
git tag v5.4.1
```

---

### 2.5 开始新对话

**工作流：** 完成一个步骤后，清除上下文开始新对话

**操作：**

```bash
# Claude Code 中
/clear
```

**新对话的标准提示词：**

```
请阅读 memory-bank/ 中的所有文档，
查看 progress.md 了解之前完成的工作（已完成到 Step [N]），
现在执行实现计划的 Step [N+1]。

要求：
1. 我会运行测试，测试通过前不要开始下一步
2. 只做这一步要求的内容，不要超前

开始吧。
```

---

### 2.6 循环直到完成

**完整工作流循环：**

```
┌─────────────────────────────────────────────────────────┐
│  1. 阅读文档 → 执行 Step N                               │
│         ↓                                               │
│  2. 测试验证                                            │
│         ↓                                               │
│  3. 通过? ─── 否 ──→ 修复 ──→ 返回步骤 2                 │
│         │                                               │
│        是                                               │
│         ↓                                               │
│  4. 更新 progress.md + architecture.md                  │
│         ↓                                               │
│  5. Git commit + tag                                    │
│         ↓                                               │
│  6. /clear 开始新对话                                   │
│         ↓                                               │
│  7. 还有步骤? ─── 是 ──→ 返回步骤 1                      │
│         │                                               │
│        否                                               │
│         ↓                                               │
│  8. 功能完成！                                          │
└─────────────────────────────────────────────────────────┘
```

---

## 🐛 第三阶段：问题处理

### 3.1 Bug 修复

**提示词：**

```
执行 Step [N] 时遇到问题：

【错误信息】
[粘贴错误日志或截图描述]

【重现步骤】
1. ...
2. ...

请分析原因并修复，不要继续下一步。
```

---

### 3.2 代码回滚

**场景：** 提示词失败或破坏了现有功能

**Claude Code 操作：**

```bash
/rewind
```

**Git 操作：**

```bash
# 回滚到上一个提交
git reset --hard HEAD~1

# 或回滚到指定标签
git reset --hard v5.4.0
```

---

### 3.3 卡住时的处理

**提示词：**

```
我在 Step [N] 卡住了，尝试了以下方法都不行：

1. [尝试方法1]
2. [尝试方法2]

当前状态：
[描述当前代码/功能状态]

请帮我分析可能的原因和解决方案。
```

---

## 📝 第四阶段：文档更新模板

### 4.1 progress.md 更新模板

**每步完成后追加：**

```markdown
---

## Step [N]: [步骤标题]

**完成时间:** YYYY-MM-DD HH:MM
**版本号:** vX.X.X

**完成内容:**
- [具体做了什么]
- [创建/修改了哪些文件]

**测试结果:**
- ✅ [测试项1] 通过
- ✅ [测试项2] 通过

**备注:**
- [遇到的问题及解决方案]
- [需要注意的事项]
```

---

### 4.2 architecture.md 更新模板

**每新增文件后追加：**

```markdown
---

## [文件路径]

**用途:** [这个文件做什么]

**主要函数/组件:**
- `functionName()` - 功能描述
- `ComponentName` - 组件描述

**依赖关系:**
- 依赖: [依赖哪些文件]
- 被依赖: [被哪些文件使用]

**数据流:**
[描述数据如何进出这个文件]
```

---

## 💡 实用技巧

### 触发 AI 深度思考

在复杂问题上，使用以下关键词（效果递增）：

```
think < think hard < think harder < ultrathink
```

**示例：**

```
这个问题比较复杂，请 think harder 后给我方案。
```

---

### 提升输出质量的提示词后缀

```
尽可能深入思考，我不着急。
重要的是你精确地按照我的要求执行，不要超前也不要遗漏。
如果我的描述不够精确，请向我提问。
```

---

### 使用 Plan Mode

在 Claude Code 中，复杂任务先用 Plan Mode：

```bash
# 按 shift+tab 进入 Plan Mode
# 或在提示词中说明
请先进入 Plan Mode，分析这个任务的实现方案，
确认方案后再开始编码。
```

---

## 📊 检查清单

### 开始新功能前

- [ ]  创建 `memory-bank/` 文件夹
- [ ]  生成 `prd.md`
- [ ]  生成 `tech-stack.md`
- [ ]  生成 `implementation-plan.md`
- [ ]  创建空白 `progress.md`
- [ ]  创建空白 `architecture.md`
- [ ]  让 AI 确认计划清晰

### 每个步骤完成后

- [ ]  测试验证通过
- [ ]  更新 `progress.md`
- [ ]  更新 `architecture.md`
- [ ]  Git commit
- [ ]  Git tag
- [ ]  `/clear` 开始新对话

### 功能完成后

- [ ]  所有步骤完成
- [ ]  回归测试通过
- [ ]  文档更新完整
- [ ]  Git push

---

## 🔗 参考资源

- **原版指南:** https://github.com/EnzeD/vibe-coding
- **Claude Code 文档:** https://docs.anthropic.com/claude-code
- **项目开发规范:** 本项目 `CLAUDE.md`

---

**文档版本:** v1.0
**创建日期:** 2025-12-16
