# 客户控制台 - 产品需求文档 (PRD)

> **产品名称**：Customer Portal 客户控制台
> **版本**：v1.0
> **创建日期**：2025-12-19
> **状态**：规划中

---

## 1. 产品概述

### 1.1 产品名称
客户控制台（Customer Portal）

### 1.2 目标用户
- 使用 Fiido AI 平台的企业客户
- 购买了 AI 产品套餐的付费用户
- 需要自助管理账户和订阅的用户

### 1.3 核心价值
- **自助服务**：客户可自主管理账户、订阅、用量，减少人工支持
- **透明计费**：清晰展示用量和账单，提升客户信任度
- **便捷操作**：在常用的工作台内即可完成所有账户操作

---

## 2. 功能列表

### 2.1 核心功能（P0 - 必须实现）

| 功能 | 说明 | 验收标准 |
|------|------|----------|
| 账户信息 | 查看/编辑企业信息、联系人 | 信息保存成功，立即生效 |
| 当前订阅 | 查看当前套餐、到期时间、权益 | 数据准确，实时更新 |
| 用量概览 | 查看各产品用量统计、剩余额度 | 图表展示，支持时间筛选 |
| 套餐升级 | 查看可用套餐，在线升级 | 升级成功，权益立即生效 |

### 2.2 重要功能（P1 - 应该实现）

| 功能 | 说明 | 验收标准 |
|------|------|----------|
| 账单列表 | 查看历史账单列表 | 分页展示，支持筛选 |
| 账单详情 | 查看单个账单明细 | 包含费用项目、金额 |
| 发票下载 | 下载 PDF 发票 | PDF 格式正确 |
| 用量明细 | 查看详细的用量记录 | 按日期、产品分类 |

### 2.3 扩展功能（P2 - 后续迭代）

| 功能 | 说明 |
|------|------|
| 在线充值 | 对接支付网关，在线充值余额 |
| 自动续费 | 设置自动续费，绑定支付方式 |
| 多用户管理 | 企业下多个子用户管理 |
| 用量预警 | 用量接近上限时自动通知 |
| API 密钥管理 | 管理 API 访问密钥 |

---

## 3. 用户故事

### 3.1 账户管理
> 作为一个企业客户，我希望能查看和修改我的企业信息，以便保持资料准确。

### 3.2 订阅管理
> 作为一个付费用户，我希望能清楚看到我当前的套餐内容和到期时间，以便了解自己的权益。

### 3.3 用量查看
> 作为一个运营人员，我希望能看到各产品的用量统计，以便掌握使用情况和成本。

### 3.4 套餐升级
> 作为一个业务增长的客户，我希望能方便地升级到更高级的套餐，以便获得更多服务额度。

### 3.5 账单查看
> 作为一个财务人员，我希望能查看和下载历史账单，以便进行财务核对和报销。

---

## 4. 非功能需求

### 4.1 性能要求

| 指标 | 要求 |
|------|------|
| 页面加载时间 | < 2 秒 |
| API 响应时间 | < 500ms |
| 并发支持 | 100+ 同时在线用户 |

### 4.2 安全要求

| 要求 | 说明 |
|------|------|
| 身份验证 | 通过 JWT Token 验证用户身份 |
| 权限控制 | 只能访问自己企业的数据 |
| 数据加密 | 敏感数据加密存储 |
| 操作审计 | 关键操作记录日志 |

### 4.3 可用性要求

| 要求 | 说明 |
|------|------|
| 响应式设计 | 支持桌面和平板 |
| 嵌入兼容 | 支持 iframe 嵌入工作台 |
| 跨浏览器 | 支持 Chrome、Firefox、Safari |

---

## 5. UI 入口设计

### 5.1 主入口：坐席工作台侧边栏

```
┌─────────────────────────────────────────────────────────────────┐
│                    坐席工作台                                    │
│  ┌──────────┐  ┌──────────────────────────────────────────┐    │
│  │ 侧边栏   │  │                                          │    │
│  │          │  │                                          │    │
│  │ 会话管理 │  │        客户控制台 (iframe)               │    │
│  │ 工单管理 │  │                                          │    │
│  │ 客户管理 │  │   ┌────────────────────────────────┐    │    │
│  │          │  │   │  当前套餐：专业版               │    │    │
│  │ ───────  │  │   │  到期时间：2025-12-31          │    │    │
│  │          │  │   │                                │    │    │
│  │ 💳 账户  │◀─│───│  用量统计                      │    │    │
│  │   与订阅 │  │   │  ▓▓▓▓▓▓▓░░░ 70%              │    │    │
│  │          │  │   │                                │    │    │
│  └──────────┘  │   │  [升级套餐] [查看账单]         │    │    │
│                │   └────────────────────────────────┘    │    │
│                └──────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 嵌入方式

```html
<!-- 坐席工作台中的嵌入代码 -->
<iframe
  src="https://portal.fiido.com/?token=xxx"
  width="100%"
  height="100%"
  frameborder="0"
></iframe>
```

---

## 6. 成功标准

| 指标 | 目标 |
|------|------|
| 客户自助率 | > 80% 的账户操作由客户自助完成 |
| 页面跳出率 | < 30% |
| 客户满意度 | NPS > 40 |
| 功能完成率 | P0 功能 100% 按期交付 |

---

## 7. 依赖分析

### 7.1 依赖的服务

| 服务 | 状态 | 说明 |
|------|------|------|
| services/billing | 待创建 | 计费核心逻辑 |
| infrastructure/security | 已有 | JWT 认证 |
| infrastructure/database | 已有 | Redis 缓存 |

### 7.2 与其他产品的关系

| 产品 | 关系 |
|------|------|
| agent_workbench | 通过侧边栏 iframe 嵌入客户控制台 |
| ai_chatbot | 调用相同的 billing 服务检查用量 |

---

## 8. 里程碑

| 阶段 | 内容 | 目标 |
|------|------|------|
| Phase 1 | 基础框架 + 账户信息 | MVP |
| Phase 2 | 订阅管理 + 用量统计 | 核心功能完成 |
| Phase 3 | 账单管理 + 嵌入工作台 | 正式上线 |
| Phase 4 | 在线充值 + 自动续费 | 增值功能 |
