# 跨模块开发技能重构计划

> **任务**：将跨模块开发拆分为两个独立技能
> **创建日期**：2025-12-22
> **参考文档**：memory-bank-guide、vibe-coding-workflow、Vibe_Coding开发规范流程说明.md

---

## 一、需求分析

### 1.1 现状问题

当前的 `cross-module-workflow` 技能混合了两个职责：
1. 文档生成（询问需求、创建 prd.md 等）
2. 开发执行（按步骤开发、测试验证等）

这与单模块开发的设计不一致：
- 单模块：`memory-bank-guide`（文档生成）+ `vibe-coding-workflow`（开发执行）
- 跨模块：仅有一个混合技能

### 1.2 目标设计

创建两个分工明确的跨模块技能：

| 技能名称 | 职责 | 对标单模块技能 |
|----------|------|----------------|
| `cross-module-docs-guide` | 跨模块功能**文档生成**指南 | `memory-bank-guide` |
| `cross-module-workflow` | 跨模块功能**开发执行**工作流 | `vibe-coding-workflow` |

### 1.3 对应关系

```
┌──────────────────────────────────────────────────────────────┐
│                       单模块开发                              │
│                                                              │
│   memory-bank-guide          →        vibe-coding-workflow   │
│   (生成 memory-bank 文档)              (按步骤执行开发)         │
│                                                              │
├──────────────────────────────────────────────────────────────┤
│                       跨模块开发                              │
│                                                              │
│   cross-module-docs-guide    →        cross-module-workflow  │
│   (生成 docs/features 文档)            (按步骤执行开发)         │
│   + 更新各模块引用                     + 更新主文档和模块引用    │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

---

## 二、详细设计

### 2.1 cross-module-docs-guide（跨模块文档生成指南）

**职责**：
- 询问用户跨模块功能需求
- 分析涉及的模块和服务
- 在 `docs/features/[功能名]/` 创建主文档
- 在各模块 `memory-bank/cross-module-refs.md` 添加引用

**触发词**：
- 「创建跨模块文档」
- 「生成跨模块需求」
- 「跨模块功能初始化」
- 「涉及多个模块的功能」

**流程**：
```
1. 询问用户需求描述
2. 分析涉及的模块（产品层、服务层、基础设施层）
3. 生成 prd.md（跨模块完整需求）
4. 生成 implementation-plan.md（按模块拆分步骤）
5. 创建 progress.md（初始化）
6. 创建 architecture.md（初始化）
7. 更新各模块 cross-module-refs.md
8. 告知用户可以开始开发
```

**输出模板**：（参考 memory-bank-guide 的详细格式）

### 2.2 cross-module-workflow（跨模块开发工作流）

**职责**：
- 读取跨模块主文档和模块 memory-bank
- 按步骤执行开发（自底向上）
- 测试验证
- 更新主文档 progress.md + architecture.md
- 更新模块 cross-module-refs.md 的涉及文件
- Git 提交

**触发词**：
- 「开始跨模块 Step」
- 「跨模块继续开发」
- 「执行跨模块下一步」
- 「按跨模块计划开发」

**流程**：
```
1. 阅读 docs/features/[功能名]/ 主文档
2. 阅读相关模块的 memory-bank（包括 cross-module-refs.md）
3. 执行当前 Step（只做当前步骤）
4. 告知用户测试方法
5. 测试通过后更新：
   - 主文档 progress.md
   - 主文档 architecture.md
   - 模块 cross-module-refs.md（涉及文件）
6. Git commit + tag
7. 继续下一步
```

---

## 三、实现步骤

### Step 1: 重命名现有 skill 目录

将 `cross-module-workflow` 重命名为 `cross-module-docs-guide`

### Step 2: 重写 cross-module-docs-guide/SKILL.md

严格参照 `memory-bank-guide/SKILL.md` 的结构和详细程度：
- 元数据头部（name, description）
- 核心原则（来自 CLAUDE.md）
- 何时使用
- 第一步：询问用户需求
- 第二步：分析涉及模块
- 第三步：生成 prd.md（模板）
- 第四步：生成 implementation-plan.md（模板）
- 第五步：创建空白追踪文件
- 第六步：更新模块引用
- 完成后的检查清单
- 后续：开始开发

### Step 3: 创建 cross-module-workflow/SKILL.md

严格参照 `vibe-coding-workflow/SKILL.md` 的结构和详细程度：
- 元数据头部（name, description）
- 何时使用
- 开始前必做（阅读文档清单）
- 执行单个 Step 的标准流程
- 测试验证
- 文档更新模板（主文档 + 模块引用）
- 完整工作流循环图
- 每步完成后的检查清单
- 问题处理
- 缺失信息处理
- 禁止事项

### Step 4: 更新 .claude/skills/README.md

添加两个新 skill 的说明

### Step 5: 更新 CLAUDE.md

更新 6.5.3 相关资源表格

---

## 四、文件清单

### 需要创建/修改的文件

| 操作 | 文件路径 |
|------|----------|
| 重命名 | `.claude/skills/cross-module-workflow/` → `.claude/skills/cross-module-docs-guide/` |
| 重写 | `.claude/skills/cross-module-docs-guide/SKILL.md` |
| 新建 | `.claude/skills/cross-module-workflow/SKILL.md` |
| 更新 | `.claude/skills/README.md` |
| 更新 | `CLAUDE.md`（6.5.3 相关资源） |

---

## 五、验收标准

1. **cross-module-docs-guide** 能够：
   - 询问用户需求
   - 分析涉及模块
   - 生成完整的 docs/features/[功能名]/ 文档
   - 更新各模块 cross-module-refs.md

2. **cross-module-workflow** 能够：
   - 读取主文档和模块文档
   - 按步骤执行开发
   - 正确更新所有相关文档
   - 遵循自底向上开发顺序

3. 两个技能有清晰的分工和触发词区分

4. 结构和详细程度与单模块版本一致
